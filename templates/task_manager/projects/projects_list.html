{% extends 'base.html' %}

{% block content %}
  <a href="{% url 'task_manager:project-create' %}" class="d-grid gap-2">
    <button class="btn btn-dark" type="button">Create project</button>
  </a>
  <br>

  <div class="progress" role="progressbar" aria-label="Projects completed"
       aria-valuenow="{{ percent_projects_completed }}" aria-valuemin="0"
       aria-valuemax="100">
    <div class="progress-bar bg-warning text-dark"
         style="width: {{ percent_projects_completed }}%">{{ percent_projects_completed|floatformat:"0" }}%
      PROJECTS COMPLETED
    </div>
  </div>
  <hr>

  <table class="table table-bordered">
    <thead>
    <tr class="text-uppercase">
      <th></th>
      <th>Project</th>
      <th>Is complete</th>
      <th>Tasks</th>
      <th>Teams</th>
      <th>Start</th>
      <th>Deadline</th>
      <th>Priority</th>
      <th>Edit</th>
    </tr>
    </thead>
    <tbody>
    {% for project_info in projects_info %}
      <tr>
        <th scope="row">{{ forloop.counter }}</th>
        <td><a href="{% url 'task_manager:project-detail' pk=project_info.id %}">{{ project_info.project_name }}</a></td>
        <td>
          <span class="badge rounded-pill {% if project_info.is_complete %}bg-danger{% else %}bg-success{% endif %}">
            {% if project_info.is_complete %}Completed{% else %}Active{% endif %}
          </span>
        </td>
        <td>
          {% for task_name, is_complete in project_info.tasks_info %}
            <div>{% if is_complete %}<del>{% endif %}<i class="bi bi-circle-fill"></i> {{ task_name }}{% if is_complete %}</del>{% endif %}</div>
          {% endfor %}
        </td>
        <td>
          {% for team in project_info.teams_info %}
            <div class="badge rounded-pill bg-success">{{ team }}</div>
          {% endfor %}
        </td>
        <td>{% for task_start_time in project_info.tasks_start_time %}<div>{{ task_start_time }}</div>{% endfor %}</td>
        <td>{% for deadline in project_info.deadlines %}<div>{{ deadline }}</div>{% endfor %}</td>
        <td>
          {% for priority in project_info.priorities %}
            <div>
              <span class="badge {% if priority == 'height' %}bg-danger{% elif priority == 'medium' %}bg-warning text-dark{% elif priority == 'urgent' %}bg-dark{% else %}bg-success{% endif %}">{{ priority }}</span>
            </div>
          {% endfor %}
        </td>
        <td class="align-middle">
          <a href="{% url 'task_manager:project-delete' project_id=project_info.id %}">
            <button type="button" class="btn btn-danger btn-sm"><i class="bi bi-trash3-fill"></i></button>
          </a>
          <a href="{% url 'task_manager:project-update' project_id=project_info.id %}">
            <button type="button" class="btn btn-dark btn-sm"><i class="bi bi-pencil"></i></button>
          </a>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% endblock %}
